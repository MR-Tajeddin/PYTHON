import smtplib, ssl, socket
from email.mime.text import MIMEText
from email.mime.multipart import MIMEMultipart
import pandas as pd

sender_email = "nezarat@enamad.ir"  # Enter your address

# read an excel file and convert 
# into a dataframe object
df = pd.DataFrame(pd.read_excel("00080.xlsx"))
# show the dataframe
receiver_email = df["Addresses"]
#receiver_email = ["yasermat.2010@gmail.com","hnhkshams@gmail.com"]#,"mr.tajeddin@gmail.com"]  # Enter receiver address
password = "Nn$123456"

HOST = "mail.enamad.ir"
PORT = 56

HOST = socket.getaddrinfo(HOST, PORT)[0][4][0]
print(HOST)

mail = smtplib.SMTP('mail.enamad.ir',465)
mail.starttls()
mail.login(sender_email, password) 
for i in range(len(receiver_email)):

    message = MIMEMultipart("alternative")
    message["Subject"] = "هشدار- اخطار تعلیق جعل لوگوی نماد اعتماد الکترونیکی"
    message["From"] = "eNAMAD <nezarat@enamad.ir>"
    message["To"] = receiver_email[i]
    html = """\
    <html>
        <body>
        <h3 dir="rtl">
      صاحب امتیاز محترم کسب و کار اینترنتی
</h3>
<p dir="rtl" style="font-size:16px">
باسلام،
</p>
<p dir="rtl" style="font-size:16px">
به اطلاع می‌رساند، به استناد ماده 525 فصل جعل و تزویر قانون مجازات اسلامی، شما مرتکب به فعل جعل نماد اعتماد الکترونیکی شده‌اید. چنانچه ظرف مدت 24 ساعت آینده نسبت به رفع آن اقدام ننمایید، دامنه کسب وکار شما فیلتر و از طرف این مرکز اقدام به تنظیم شکایت کیفری خواهدشد
</p>
<p>
<a href="https://enamad.ir/"> https://enamad.ir/ </a>
: نماد اعتماد الکترونیکی
</p>

       </body>
     </html>
    """

    # Turn these into plain/html MIMEText objects
    part2 = MIMEText(html, "html")
    print(receiver_email[i])

    # Add HTML/plain-text parts to MIMEMultipart message
    # The email client will try to render the last part first
    message.attach(part2)
    mail.sendmail(sender_email, receiver_email[i], message.as_string())
